import sys
import os

# Add the root directory to the system path for proper imports
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))

from sqlalchemy.orm import Session
from models.recipe_model import Recipe, Ingredient, NutritionalInfo, CookingTimer
from models.user_model import User
from db.database import SessionLocal, init_db
from passlib.context import CryptContext
from services.ai_service import calculate_nutritional_info 
from services.timer_service import start_timer  

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

STATIC_RECIPE_DIR = "static"
os.makedirs(STATIC_RECIPE_DIR, exist_ok=True)

def load_seed_data(db: Session):
    try:
        print("🚀 Starting seed data loading process...")

        # Initialize the database
        init_db()

        # Check if an admin user exists
        admin_user = db.query(User).filter(User.email == "admin@plateful.com").first()
        if not admin_user:
            hashed_password = pwd_context.hash("admin123")
            admin_user = User(
                username="admin",
                email="admin@plateful.com",
                password_hash=hashed_password,
                first_name="Admin",
                last_name="User"
            )
            db.add(admin_user)
            db.commit()
            db.refresh(admin_user)
            print("✅ Admin user created successfully")

        # Skip seeding if there are already 5 or more recipes
        recipe_count = db.query(Recipe).count()
        if recipe_count >= 5:
            print(f"✅ Database already has {recipe_count} recipes. Skipping seed data.")
            return

        # Seed default recipes (seed_recipes should be defined with recipe data)
        seed_recipes = [
            {
                "name": "שקשוקה",
                "preparation_steps": "1.	מרתיחים בסיר גדול מים.\n2.	חורצים X בתחתית העגבניות וחולטים 3 דקות במים הרותחים כדי שיהיה ניתן לקלפן בקלות.\n3.	קוצצים גס את העגבניות הקלופות. \n4.	מחממים מחבת ומוסיפים את שמן הזית. \n5.	פורסים את הפלפל החריף לטבעות ומוסיפים למחבת. מערבבים כ-2 דקות עד שמזהיב ויש ריח פלפל באוויר. \n6.	פורסים את שיני השום ומוסיפים למחבת יחד הפפריקה והסוכר. מערבבים היטב. \n7.	מוסיפים למחבת את העגבניות הקצוצות, מים ורסק עגבניות, מביאים לרתיחה ומבשלים על אש נמוכה בערך 10-15 דקות. מערבבים מדי פעם ומתבלים במלח ופלפל. \n8.	מוסיפים בעדינות את הביצים אחת אחרי השניה. הכי טוב לא סתם לזרוק את הביצים פנימה, אלא ליצור גומה קטנה ולתוכה לשפוך את הביצה. \n9.	מתבלים את פני הביצים במעט מלח. \n10.	השקשוקה שלכם מוכנה לזלילה ברגע שחלבון הביצה מתקרש והחלמון מתקשה על פי טעמכם (יותר נוזלי או פחות נוזלי). מעטרים בפטרוזיליה ומגישים חם. \n",
                "cooking_time": 30,
                "servings": 4,
                "categories": "ארוחת בוקר",
                "tags": "פרווה" ,
                "image_filename": "shakshuka.jpg",
                "ingredients": [
                    {"name": "עגבניות", "quantity": 0.5, "unit": "קילו"},
                    {"name": "שמן זית", "quantity": 3, "unit": "כפות"},
                    {"name": "פלפל צ'ילי אדום", "quantity": 1, "unit": "יחידה"},
                    {"name": "פפריקה מתוקה", "quantity": 1, "unit": "כפית"},
                    {"name": "שיני שום", "quantity": 4, "unit": "יחידות"},
                    {"name": "רסק עגבניות", "quantity": 2, "unit": "כפות"},
                    {"name": "ביצים", "quantity": 5, "unit": "יחידות"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 0.5, "unit": "כפית"},
                    {"name": "מים", "quantity": 1, "unit": "כוס"},
                ],
                "timers": [
                    {"step_number": 7, "duration": 15, "label": "בישול לפני הכנסת הביצים"},
                    {"step_number": 10, "duration": 10, "label": "בישול לאחר הכנסת הביצים"}
                ],
                "nutrition": {
                    "calories": 884.75,
                    "protein": 9.47,
                    "carbs": 375.03,
                    "fats": 31.45
                }
            },
            {
                "name": "פנקייק בננה",
                "preparation_steps": "1.	מנפים קמח ואבקת אפייה לקערת מיקסר או לקערה גדולה. מוסיפים סוכר ומלח ומערבבים.\n2.	מוסיפים לקערה ביצים, חלב, שמן, תמצית וניל ובננות ומערבבים במיקסר עם וו הקצפה או בקערה גדולה עם מטרפה. \n3.	מחממים מחבת (מומלץ נון סטיק) על להבה נמוכה - בינונית. \n4.	משמנים את פני המחבת בשכבה דקה של שמן (אפשר תרסיס). \n5.	יוצקים בעזרת מצקת את בלילת הפנקייק על המחבת. מטגנים למשך כ-2 דקות עד שמופיעות בועות על גבי הפנקייק, הופכים ומטגנים עוד כדקה. \n6.	מגישים את הפנקייק עם פרוסות בננה וסירופ מייפל או סירופ שוקולד. \n",
                "cooking_time": 20,
                "servings": 8,
                "categories": "ארוחת בוקר",
                "tags": "חלבי" ,
                "image_filename": "pancake_banana.jpg",
                "ingredients": [
                    {"name": "קמח לבן", "quantity": 230, "unit": "גרם"},
                    {"name": "אבקת אפייה", "quantity": 10, "unit": "גרם"},
                    {"name": "סוכר לבן", "quantity": 3, "unit": "כפות"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "חלב", "quantity": 1, "unit": "כוס"},
                    {"name": "ביצים", "quantity": 2, "unit": "יחידות"},
                    {"name": "שמן קנולה", "quantity": 3, "unit": "כפות"},
                    {"name": "תמצית וניל", "quantity": 1, "unit": "כפית"},
                    {"name": "בננות", "quantity": 2, "unit": "יחידות"},
                    {"name": "סירופ שוקולד", "quantity": 3, "unit": "כפות"},
                ],
                "timers": [
                    {"step_number": 3, "duration": 5, "label": "חימום המחבת היטב"},
                    {"step_number": 6, "duration": 2, "label": "טיגון עד הופעת בועות"}
                ],
                "nutrition": {
                    "calories": 345.75,
                    "protein": 3.53,
                    "carbs": 210.37,
                    "fats": 14.49
                }
            },
            {
                "name": "בורקס תורכי",
                "preparation_steps": "1.	מחממים תנור לחום של 180 מעלות.\n2.	מחממים שמן זית במחבת ומוסיפים את הבצל הקצוץ ומטגנים היטב. \n3.	מוסיפים את התירס ומטגנים עוד 5 דקות תוך כדי ערבוב. \n4.	שופכים את התירס והבצל לקערה, מוסיפים גבינה, מלח, פלפל, שמיר וקמח ומערבבים היטב. \n5.	מחלקים את הבלילה המוכנה ל-8 קאפקייקס. ומכניסים לתנור למשך 40 דקות, או עד שהחלק העליון של המאפה הופך לזהוב. \n6.	מומלץ להגיש עם ירקות חתוכים טריים. \n",
                "cooking_time": 55,
                "servings": 12,
                "categories": "ארוחת בוקר",
                "tags": "חלבי " ,
                "image_filename": "borax.png",
                "ingredients": [
                    {"name": "קמח", "quantity": 1, "unit": "קילו"},
                    {"name": "מים", "quantity": 2.5, "unit": "כוסות"},
                    {"name": "חומץ", "quantity": 2, "unit": "כפות"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "חלב", "quantity": 1, "unit": "כוס"},
                    {"name": "שמן קנולה", "quantity": 2, "unit": "כוסות"},
                    {"name": "עלי תרד", "quantity": 1, "unit": "חבילה"},
                    {"name": "גבינה בולגרית", "quantity": 1, "unit": "קופסא"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "ביצה", "quantity": 1, "unit": "יחידה"},
                    {"name": "שומשום", "quantity": 5, "unit": "כפות"},
                ],
                "timers": [
                    {"step_number": 1, "duration": 12, "label": "לישת הבצק"},
                    {"step_number": 4, "duration": 60, "label": "המתנה לפני אפייה"},
                    {"step_number": 8, "duration": 15, "label": "אפייה"},
                ],
                "nutrition": {
                    "calories": 285.08,
                    "protein": 3.85,
                    "carbs": 234.79,
                    "fats": 17.55
                }
            },
            {
                "name": "מאפינס תירס",
                "preparation_steps": "1.	מכינים את הבצק: בקערת מיקסר שמים את כל מרכיבי הבצק (ללא השמן), ולשים עד לקבלת בצק חלק ואחיד - אם הבצק יבש מידי מוסיפים עוד עד כחצי כוס מים.\n2.	מחלקים את הבצק ל-12-15 יחידות, יוצרים מכל חלק כדור, משטחים מעט ומניחים בתבנית חד פעמית. \n3.	שופכים 2 כוסות שמן על הבצק, מכסים בניילון נצמד ומכניסים .\n4.	מוצאים מהמקרר כשעה לפני האפייה ומחממים תנור לחום של 200 מעלות טורבו. \n5.	מכינים את המילוי: שוטפים את התרד היטב, סוחטים ומערבבים עם גבינה בולגרית, מלח ופלפל (בסוף המתכון צירפתי עוד אופציות למילוי). \n6.	על משטח עבודה פותחים כל כדור עם ידיים משומנות, כמה שיותר דק יותר טוב. השתמשו בשמן של ההשריה לבצק ולידיים. \n7.	מניחים את המילוי לכל אורך השוליים התחתונים, מגלגלים לרולדה ומגלגלים את הבצק לצורת שבלול. \n8.	מברישים בביצה, מפזרים שומשום, מניחים על תבנית עם נייר אפייה ומכניסים לאפייה בתנור שחומם מראש עד שמזהיב. \n",
                "cooking_time": 55,
                "servings": 12,
                "categories": "ארוחת בוקר",
                "tags": "טבעוני, פרווה" ,
                "image_filename": "corn_muffins.jpg",
                "ingredients": [
                    {"name": "גרגירי תירס", "quantity": 250, "unit": "גרם"},
                    {"name": "בצל", "quantity": 1, "unit": "יחידה"},
                    {"name": "שמן זית", "quantity": 2, "unit": "כפות"},
                    {"name": "גבינת סויה", "quantity": 2, "unit": "גביעים"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 2, "unit": "כפיות"},
                    {"name": "שמיר", "quantity": 2, "unit": "כפות"},
                    {"name": "קמח לבן", "quantity": 8, "unit": "כפות"}
                ],
                "timers": [
                    {"step_number": 3, "duration": 5, "label": "טיגון עם התירס"},
                    {"step_number": 5, "duration": 40, "label": "אפייה"}
                ],
                "nutrition": {
                    "calories": 280.0,
                    "protein": 5.39,
                    "carbs": 138.55,
                    "fats": 9.82
                }
            },
            #ארוחת צהריים 
            {
                "name": "סטיק כרובית",
                "preparation_steps": "1.	משרים את ראשי הכרובית במים חמים מומלחים ל-10 דקות. זה ירחיק את כל דיירי המשנה שהתכרבלו בכרובית עוד כשהייתה גור כרוביות קטן בשדה.\n2.	חותכים את הכרובית לפרוסות בעובי של 1.5-2 ס”מ לרוחב. בעצם מתקבלות פרוסות בצורה של “עץ” שבמרכזו גבעול הכרובית.\n3.	מערבבים בקערה את חומרי במשרה. \n4.	משרים את פרוסות הכרובית כמה שבא לכם. זה יכול להיות כמה דקות, ויכול להיות לילה שלם במקרר. כל המרבה הרי זה משובח. \n5.	מחממים תנור לחום של 200 מעלות. \n6.	עוטפים תבנית תנור בנייר אפייה ומניחים את פרוסות סטייק הכרובית. אם במקרה נפלו כמה תפרחות שימו גם אותן, אתם תריבו על כל פירור! באחריות! \n7.	אופים את הכרוביות 10 דקות על צד אחד ואז הופכים לצד השני לעוד 10 דקות. \n8.	מגישים עם טחינה או יוגורט או כל רוטב אחר שאוהבים. \n",
                "cooking_time": 30,
                "servings": 4,
                "categories": "ארוחת צהריים",
                "tags": "טבעוני, פרווה" ,
                "image_filename": "cauliflower_steak.jpg",
                "ingredients": [
                    {"name": "כרובית", "quantity": 2, "unit": "יחידות"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "סילאן", "quantity": 3, "unit": "כפות"},
                    {"name": "שמן זית", "quantity": 0.5, "unit": "כוס"},
                    {"name": "שיני שום", "quantity": 3, "unit": "יחידות"},
                    {"name": "פלפל שחור גרוס", "quantity": 2, "unit": "כפית"},
                    {"name": "שמיר", "quantity": 0.5, "unit": "כפית"},
                    {"name": "כוסברה", "quantity": 0.5, "unit": "כוס"},
                    {"name": "צ'ילי אדום", "quantity": 1, "unit": "יחידה"},
                    {"name": "מיץ לימון", "quantity": 0.5, "unit": "כוס"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 10, "label": "השרייה של הכרובית"},
                    {"step_number": 7, "duration": 10, "label": "אפייה"}
                ],
                "nutrition": {
                    "calories": 1200.5,
                    "protein": 8.37,
                    "carbs": 398.75,
                    "fats": 33.73
                }
            },            
            {
                "name": "פסטה ברוטב בולונז",
                "preparation_steps": "1.	קולפים וקוצצים לקוביות קטנות את הגזר, הבצל, שורש הסלרי והשום.\n2.	מחממים את שמן הזית בסיר רחב ומטגנים את הירקות כ-5 דקות. \n3.	מוסיפים לסיר את הבשר הטחון, מתבלים במלח, פלפל שחור ושבבי צ’ילי יבש ומטגנים עד שהבשר משנה את צבעו ומשחים. \n4.	מוסיפים את עלי המרווה, רוטב העגבניות ורכז העגבניות, מביאים לרתיחה ומבשלים על להבה נמוכה כ-45 דקות. \n5.	מבשלים את הפסטה לפי הוראות היצרן, מסננים ומניחים בקערה. \n6.	מערבבים את הפסטה עם הרוטב, מקשטים בעלי בזיליקום שלמים ומגישים בצלחות פסטה צבעוניות משגעות. \n",
                "cooking_time": 60,
                "servings": 5,
                "categories": "ארוחת צהריים",
                "tags": "בשרי" ,
                "image_filename": "pasta.jpg",
                "ingredients": [
                    {"name": "שמן זית", "quantity": 4, "unit": "כפות"},
                    {"name": "גזר", "quantity": 1, "unit": "יחידה"},
                    {"name": "בצל סגול", "quantity": 1, "unit": "יחידה"},
                    {"name": "שורש סלרי", "quantity": 1, "unit": "יחידות"},
                    {"name": "שיני שום", "quantity": 3, "unit": "יחידות"},
                    {"name": "בשר בקר טחון", "quantity": 1, "unit": "קילו"},
                    {"name": "מלח", "quantity": 0.5, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 0.25, "unit": "כפית"},
                    {"name": "צ'ילי יבש", "quantity": 0.5, "unit": "כפית"},
                    {"name": "עלי מרווה", "quantity": 5, "unit": "יחידות"},
                    {"name": "רוטב עגבניות", "quantity": 2, "unit": "כוסות"},
                    {"name": "רסק עגבניות", "quantity": 2, "unit": "כפות"},
                    {"name": "פסטה קצרה", "quantity": 500, "unit": "גרם"},
                    {"name": "בזיליקום", "quantity": 10, "unit": "עלים"},
                ],
                "timers": [
                    {"step_number": 2, "duration": 5, "label": "טיגון הירקות"},
                    {"step_number": 4, "duration": 45, "label": "רתיחה"}
                ],
                "nutrition": {
                    "calories": 1138.6,
                    "protein": 13.73,
                    "carbs": 339.61,
                    "fats": 34.6
                }
            },
            {
                "name": "פילה אמנון בתנור",
                "preparation_steps": "1.	משרים את הדג: יש להשרות את הדג כחצי שעה במיץ לימון ומעט מלח גס.\n2.	לאחר ההשרייה שוטפים היטב היטב את הפילטים של דג האמנון היטב ומסדרים על נייר אפייה בתבנית תנור.\n3.	מתבלים ומורחים: בקערית נערבב את השמן יחד עם כל התבלינים. \n4.	בעזרת מברשת סיליקון נמרח את משחת התבלינים על הפילטים של דג האמנון, חשוב למרוח את האמנון מכל הצדדים. \n5.	אופים את הדגים בתנור שחומם מראש ל- 200 מעלות 12-14 דקות (תלוי בגודל הדג), עד שהאמנון מקבל צבע יפה. \n",
                "cooking_time": 50,
                "servings": 4,
                "categories": "ארוחת צהריים",
                "tags": "פרווה, דגים" ,
                "image_filename": "fish.jpg",
                "ingredients": [
                    {"name": "מיץ לימון", "quantity": 0.5, "unit": "כוס"},
                    {"name": "מלח גס", "quantity": 0.5, "unit": "כפית"},
                    {"name": "דג אמנון", "quantity": 4, "unit": "יחידות"},
                    {"name": "כורכום", "quantity": 0.25, "unit": "כפיות"},
                    {"name": "שמן זית", "quantity": 4, "unit": "כפות"},
                    {"name": "מים", "quantity": 3, "unit": "כפות"},
                    {"name": "פלפל שחור גרוס", "quantity": 0.25, "unit": "כפית"},
                    {"name": "מלח גס", "quantity": 0.5, "unit": "כפית"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 30, "label": "השרייה של הדג"},
                    {"step_number": 5, "duration": 12, "label": "אפייה"}
                ],"nutrition": {
                    "calories": 788.0,
                    "protein": 11.2,
                    "carbs": 61.03,
                    "fats": 30.66
                }
            },
            {
                "name": "קציצות בשר רכות",
                "preparation_steps": "1.	בקערה שמים את מרכיבי תערובת הבשר ולשים למשך 3 דקות.\n2.	יוצרים מהתערובת כדורים, משטחים מעט ומטגנים על כיריים במחבת טיגון קל לסגירת הבשר (ממש דקה מכל צד).\n3.	מעבירים את השמן שטיגנו בו את הקציצות לסיר שטוח ורחב, מוסיפים עוד קצת שמן במידת הצורך ומטגנים את הבצל החתוך גס עד לשקיפות.\n4.	מוסיפים לסיר את כל שאר מרכיבי הרוטב חוץ מתפוחי האדמה.\n5.	מבשלים עם מכסה סגור למשך 5 דקות. מוסיפים את הקציצות ותפוחי האדמה.\n6.	מוספים מים עד גובה תפוחי האדמה ומבשלים על אש נמוכה עד שתפוחי האדמה מתרככים.\n",
                "cooking_time": 50,
                "servings": 20,
                "categories": "ארוחת צהריים",
                "tags": "בשרי " ,
                "image_filename": "meatballs.jpg",
                "ingredients": [
                    {"name": "צלעות בקר", "quantity": 0.5, "unit": "קילו"},
                    {"name": "פטרוזיליה", "quantity": 1, "unit": "צרור"},
                    {"name": "בצל", "quantity": 1, "unit": "יחידה"},
                    {"name": "פירורי לחם", "quantity": 2, "unit": "כפות"},
                    {"name": "רסק עגבניות", "quantity": 1, "unit": "כף"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "אריסה", "quantity": 1, "unit": "כפית"},
                    {"name": "שמן קנולה", "quantity": 2, "unit": "כפות"},
                    {"name": "מים", "quantity": 3, "unit": "כפות"},
                    {"name": "בצל", "quantity": 1, "unit": "יחידה"},
                    {"name": "רסק עגבניות", "quantity": 2, "unit": "כפות"},
                    {"name": "עגבניות", "quantity": 2, "unit": "יחידות"},
                    {"name": "פפריקה מתוקה", "quantity": 1, "unit": "כף"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פפריקה חריפה", "quantity": 0.5, "unit": "כפית"},
                    {"name": "כורכום", "quantity": 0.5, "unit": "כפית"},
                    {"name": "תפוח אדמה", "quantity": 3, "unit": "יחידות"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 3, "label": "ללוש את הבשר"},
                    {"step_number": 5, "duration": 5, "label": "בישול עם מכסה סגור"},
                    {"step_number": 6, "duration": 40, "label": "בישול עד ריכוך"}
                ],
                "nutrition": {
                    "calories": 265.65,
                    "protein": 4.7,
                    "carbs": 151.22,
                    "fats": 6.95
                }
            },
            #ארוחת ערב 
           {
                "name": "טורטיה מקסיקנית עם עוף",
                "preparation_steps": "1.	משרים את נתחי העוף ברוטב הטריאקי במשך כ-20 דקות, במטרה לרכך את הבשר ולהעמיק את הטעמים.\n2.	מלהיטים מחבת עם שמן זית. מוציאים את נתחי העוף מהטריאקי ומטגנים עד שהם משנים את צבעם ומזהיבים מעט. \n3.	מוסיפים את רוטב הטריאקי ומבשלים עוד כמה דקות. \n4.	מכינים את הסלט: קוצצים את העגבניות ואת הבצל לקוביות קטנות, קוצצים גם את הכוסברה. \n5.	מערבבים את כל הירקות יחד בקערה ומתבלים בשמן זית, מלח ופלפל. \n6.	מלהיטים מחבת נקייה ומטגנים עליה את הטורטיות, כל טורטייה כדקה מכל צד, רק כדי שתהיה גמישה וטעמה ישתבח. \n7.	מניחים את הטורטייה על צלחת, שמים עליה עלה חסה, שתי כפות מסלט העגבניות, נתחי עוף, בצל ירוק, ופרוסות פלפל חלפיניו, כמה שאוהבים. מגלגלים ואוכלים. \n",
                "cooking_time": 40,
                "servings": 4,
                "categories": "ארוחת ערב",
                "tags": "בשרי, קליל" ,
                "image_filename": "tortilla.jpg",
                "ingredients": [
                    {"name": "טורטיות", "quantity": 4, "unit": "יחידות"},
                    {"name": "פילה עוף", "quantity": 400, "unit": "גרם"},
                    {"name": "רוטב טריאקי", "quantity": 6, "unit": "כפות"},
                    {"name": "שמן זית", "quantity": 1, "unit": "כף"},
                    {"name": "מלח", "quantity": 0.5, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "עגבניות", "quantity": 3, "unit": "יחידות"},
                    {"name": "כוסברה", "quantity": 1, "unit": "צרור"},
                    {"name": "בצל סגול", "quantity": 1, "unit": "יחידה"},
                    {"name": "שמן זית", "quantity": 1, "unit": "כף"},
                    {"name": "מלח", "quantity": 0.5, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "חסה", "quantity": 4, "unit": "עלים"},
                    {"name": "בצל ירוק", "quantity": 2, "unit": "יחידה"},
                    {"name": "פלפל חלפיניו כבוש", "quantity": 1, "unit": "יחידה"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 20, "label": "להשרות את הבשר ברוטב"},
                    {"step_number": 3, "duration": 6, "label": "בישול "}
                ],
                "nutrition": {
                    "calories": 1579.25,
                    "protein": 21.55,
                    "carbs": 745.6,
                    "fats": 67.42
                }
            },
            {
                "name": "סושי בייתי",
                "preparation_steps": "1.	מכינים את האורז: משרים את האורז בקערה גדולה עם מים ומסננים היטב עד שהמים יוצאים צלולים.\n2.	מכניסים את האורז לסיר, מוסיפים מים, מכסים במכסה ומביאים לרתיחה. \n3.	מעבירים את הסיר ללהבה נמוכה וממשיכים לבשל כ-20 דקות עד לריכוך האורז. \n4.	במקביל לבישול האורז. ממיסים את הסוכר והמלח בחומץ האורז, אפשר לחמם מעט בכיריים כדי לזרז את התהליך. \n5.	מכבים את האורז, משאירים את הסיר מכוסה ומניחים לאורז לנוח כ-15 דקות. \n6.	מעבירים את האורז לקערה גדולה, שופכים מעל את החומץ המתובל ומערבבים בזהירות. מניחים לאורז להתקרר. \n7.	מכינים את הסושי: עוטפים את המחצלת היטב בניילון נצמד. \n8.	מנחים אצה על המחצלת (כשהצד המחוספס כלפי מעלה), מעל האצה שכבר דקה של האורז (משאירים שוליים של 2 ס”מ מלמעלה). \n9.	בחלק של האצה הקרוב אלינו מניחים את הדג והירקות ומתחילים לגלגל בעזרת המחצלת תוך כדי שמהדקים היטב לאורך כל דרך הגלגול. \n10.	חותכים את הרול ל-8 חלקים עם סכין חדה ורטובה, מגישים לצד רטבים וזוללים! \n",
                "cooking_time": 120,
                "servings": 8,
                "categories": "ארוחת ערב",
                "tags": "פרווה, ללא גלוטן" ,
                "image_filename": "soshi.jpg",
                "ingredients": [
                    {"name": "אורז עגול", "quantity": 4, "unit": "כוסות"},
                    {"name": "מים", "quantity": 4, "unit": "כוסות"},
                    {"name": "חומץ אורז", "quantity": 0.5, "unit": "כוס"},
                    {"name": "סוכר לבן", "quantity": 2, "unit": "כפות"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "אצות נורי", "quantity": 1, "unit": "חבילה"},
                    {"name": "מלפפון", "quantity": 2, "unit": "יחידות"},
                    {"name": "אבוקדו", "quantity": 1, "unit": "יחידה"},
                    {"name": "דג סלמון", "quantity": 100, "unit": "גרם"},
                    {"name": "עירית", "quantity": 1, "unit": "צרור"}
                ],
                "timers": [
                    {"step_number": 3, "duration": 20, "label": "בישול האורז"},
                    {"step_number": 5, "duration": 15, "label": "מנוחה "}
                ],
                "nutrition": {
                    "calories": 328.75,
                    "protein": 3.15,
                    "carbs": 182.59,
                    "fats": 30.35
                }
            },
            {
                "name": "פיצה כמו באיטליה",
                "preparation_steps": "1.	מכינים את הבצק: בקערה, שמים את הקמח והמלח, מערבבים קלות ויוצרים גומה קטנה במרכז, מוסיפים את שאר המצרכים (מתוך כל כמות שמן הזית שמים 3 כפות) ולשים היטב עד שהמתקבל בצק אחיד, חלק וגמיש ויוצרים ממנו כדור.\n2.	בקערה נקייה שמים 3 כפות שמן זית, מניחים את כדור הבצק ועוטפים אותו היטב בשמן הזית (כך שלא ידבק בעת הוצאתו לתבנית) מכסים בניילון נצמד ומניחים להתפחה של שעה וחצי, למי שיש יותר זמן- התפיחו במקרר ל-24 שעות, זה יתן לבצק אווריריות משגעת. \n3.	על משטח מקומח מוציאים את הבצק מהקערה וחוצים אותו ל-2 חצאים שווים. \n4.	מחממים תנור לחום של 240 מעלות טורבו. \n5.	בעזרת כפות הידיים פותחים מעט את הבצק, מרפדים תבנית בנייר אפייה ומניחים עליה את הבצק, אפשר להשתמש גם בתבנית מיוחדת לפיצה, מעבירים לתבנית ובעזרת לחיצות קלות יוצרים מעין מסגרת מסביב לפיצה. \n6.	מותחים את הבצק כך שיהיה לא עבה מידי ולא דק מידי (שלא יקרע). \n7.	מכינים את הפיצה: שמים מצקת קטנה מרוטב העגבניות (למשקיענים רוטב לפיצה: אפשר להניח את הרוטב בסיר ולתבל לפי הטעם, להוסיף קצת שום, בזיליקום, אורגנו, מלח ופלפל), מפזרים מוצרלה מגורדת וגבינת פרמזן ומעט עלי בזיליקום. \n8.	מכניסים לתנור שחומם מראש עד להשחמה. בודקים לאחר 12 דקות מה המצב, בעזרת מרית מרימים את הפיצה ובודקים את צבעו של הבצק בתחתית, אם עדיין בהיר, אופים עוד, אחרי 5 דקות בודקים שוב וחוזר חלילה לפי מידת הצורך בהתאם לעוצמת התנור. \n9.	מוציאים מהתנור ומצננים כ-3 דק’ לפני שחותכים. מפנימים שיצא לנו פיצה אליפות. בתיאבון! \n",
                "cooking_time": 120,
                "servings": 2,
                "categories": "ארוחת ערב",
                "tags": "חלבי" ,
                "image_filename": "pizza.jpg",
                "ingredients": [
                    {"name": "קמח פיצה", "quantity": 525, "unit": "גרם"},
                    {"name": "מים", "quantity": 1.5, "unit": "כוסות"},
                    {"name": "שמרים יבשים", "quantity": 2, "unit": "כפיות"},
                    {"name": "שמן זית", "quantity": 6, "unit": "כפות"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "סוכר לבן", "quantity": 1.5, "unit": "כפיות"},
                    {"name": "רוטב עגבניות", "quantity": 1, "unit": "יחידה"},
                    {"name": "גבינת מוצרלה", "quantity": 500, "unit": "גרם"},
                    {"name": "פרמזן", "quantity": 100, "unit": "גרם"},
                    {"name": "בזיליקום", "quantity": 1, "unit": "צרור"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 15, "label": "לישת הבצק"},
                    {"step_number": 2, "duration": 90, "label": "התפחה "},
                    {"step_number": 8, "duration": 12, "label": "אפייה "},
                ],
                "nutrition": {
                    "calories": 2583.0,
                    "protein": 47.87,
                    "carbs": 796.1,
                    "fats": 78.61
                }
            },
            {
                "name": "לביבות תפוח אדמה",
                "preparation_steps": "1.	גוררים את הבצל ואת תפוחי האדמה. מניחים במסננת וסוחטים להוצאת הנוזלים.\n2.	מעבירים את תפוחי האדמה והבצל לקערה ומוסיפים את הביצים, הקמח והמלח. מערבבים היטב.\n3.	מחממים שמן במחבת גדולה (שמן בעומק של כ-1 ס”מ).\n4.	יוצרים לביבות בעזרת הידיים בקוטר של כ-4 ס”מ ולא שמנמנות מדי ומניחים בשמן החם, כל פעם 4 לביבות במחבת לא יותר.\n5.	מזהיבים מצד אחד, הופכים ומזהיבים גם מהצד השני.\n6.	מערבבים בקערית את השמנת החמוצה עם הבצל הירוק והמלח ומגישים לצד הלטקס.\n",
                "cooking_time": 25,
                "servings": 20,
                "categories": "ארוחת ערב",
                "tags": "חלבי, פרווה" ,
                "image_filename": "pancake.jpg",
                "ingredients": [
                    {"name": "תפוח אדמה", "quantity": 5, "unit": "יחידות"},
                    {"name": "בצל", "quantity": 2, "unit": "יחידות"},
                    {"name": "ביצים", "quantity": 2, "unit": "יחידות"},
                    {"name": "קמח לבן", "quantity": 4, "unit": "כפות"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "שמן קנולה", "quantity": 2, "unit": "כוסות"},
                    {"name": "שמנת חמוצה", "quantity": 1, "unit": "מיכל"},
                    {"name": "בצל ירוק", "quantity": 1, "unit": "יחידה"},
                    {"name": "מלח", "quantity": 0.5, "unit": "כפית"}
                ],
                "timers": [],
                "nutrition": {
                    "calories": 105.05,
                    "protein": 1.86,
                    "carbs": 141.36,
                    "fats": 7.03
                }
            },
            #סלטים
           {
                "name": "סלט קינאה ובטטה",
                "preparation_steps": "1.	מכינים את הקינואה: בסיר על אש בינונית שמים כוס קינואה, מלח, כף שמן ו-2 כוסות מים ומביאים לרתיחה.\n2.	מבשלים כ-15 דקות עד שהמים מתאדים, מכבים ומורידים מהאש.\n3.	מכסים את הסיר במגבת 10 דקות ומצננים לחלוטין.\n4.	מחממים תנור ל-180 מעלות חום עליון תחתון. \n5.	מכינים את הבטטות: מקלפים את הבטטות וחותכים לקוביות. \n6.	מרפדים תבנית בנייר אפיה, שמים את הבטטות, מרססים בספרי שמן ואופים כ-20 דקות. \n7.	מוציאים מהתנור ומצננים. \n8.	בקערת הגשה שמים קינואה, בטטה, בצל ירוק, כוסברה, פטרוזיליה, חמוציות ושקדים. \n9.	מכינים את הרוטב: מערבבים את כל המצרכים עד לקבלת רוטב אחיד, שופכים על גבי הסלט מערבבים ומגישים \n",
                "cooking_time": 50,
                "servings": 6,
                "categories": "סלטים",
                "tags": "טבעוני, פרווה" ,
                "image_filename": "quinoa.jpg",
                "ingredients": [
                    {"name": "קינואה", "quantity": 1, "unit": "כוס"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "שמן קנולה", "quantity": 1, "unit": "כף"},
                    {"name": "מים", "quantity": 2, "unit": "כוסות"},
                    {"name": "בטטה", "quantity": 2, "unit": "יחידות"},
                    {"name": "שקדים קלויים", "quantity": 0.5, "unit": "כוס"},
                    {"name": "בצל ירוק", "quantity": 2, "unit": "יחידה"},
                    {"name": "כוסברה", "quantity": 1, "unit": "צרור"},
                    {"name": "פטרוזיליה", "quantity": 1, "unit": "צרור"},
                    {"name": "חמוציות מיובשות", "quantity": 0.25, "unit": "כוס"},
                    {"name": "שמן זית", "quantity": 6, "unit": "כף"},
                    {"name": "מיץ לימון", "quantity": 1, "unit": "כף"},
                    {"name": "סילאן", "quantity": 1, "unit": "כף"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"}
                ],
                "timers": [
                    {"step_number": 2, "duration": 15, "label": "בישול הקינואה"},
                    {"step_number": 3, "duration": 10, "label": "מנוחה "},
                    {"step_number": 6, "duration": 20, "label": "אפיית הבטטה "},
                ],
                "nutrition": {
                    "calories": 881.83,
                    "protein": 8.46,
                    "carbs": 483.61,
                    "fats": 45.88
                }
            },
            {
                "name": "חמוצים יפניים",
                "preparation_steps": "1.	חותכים את כל הירקות לרצועות או לקוביות.\n2.	מכניסים את הירקות ואת מצרכי הרוטב לתוך שקיות זיפר.\n3.	סוגרים היטב את השקית ומשקשקים אותה לכל הכיוונים כך שהירקות מצופים ברוטב.\n4.	לאחר מכן מניחים את השקית עם הירקות במקרר למשך שעתיים - והחמוצים מוכנים.\n5.	בעת ההגשה מפזרים מלמעלה מעט שומשום שחור.\n",
                "cooking_time": 60,
                "servings": 1,
                "categories": "סלטים",
                "tags": "פרווה, ללא גלוטן" ,
                "image_filename": "pickles.jpg",
                "ingredients": [
                    {"name": "מלפפון", "quantity": 2, "unit": "יחידות"},
                    {"name": "כרוב לבן", "quantity": 1, "unit": "יחידות"},
                    {"name": "כרובית", "quantity": 1, "unit": "יחידה"},
                    {"name": "גזר", "quantity": 2, "unit": "יחידות"},
                    {"name": "פלפל אדום", "quantity": 1, "unit": "יחידה"},
                    {"name": "פלפל צהוב", "quantity": 1, "unit": "יחידה"},
                    {"name": "מים", "quantity": 1, "unit": "כוס"},
                    {"name": "סוכר לבן", "quantity": 0.5, "unit": "כוס"},
                    {"name": "חומץ", "quantity": 0.5, "unit": "כוס"},
                    {"name": "שן שום", "quantity": 2, "unit": "יחידות"},
                    {"name": "פלפל צ'ילי אדום", "quantity": 1, "unit": "יחידה"},
                    {"name": "מלח", "quantity": 2, "unit": "כפיות"},
                    {"name": "שמן שומשום", "quantity": 1, "unit": "כפית"}
                ],
                "timers": [
                    {"step_number": 4, "duration": 120, "label": "השרייה"}
                ],
                "nutrition": {
                    "calories": 2505.0,
                    "protein": 21.15,
                    "carbs": 1542.16,
                    "fats": 160.43
                }
            },
            {
                "name": "סלט ירוק עם רוטב ויניגרט",
                "preparation_steps": "1.	מכינים את הסלט: מכינים קערת מי קרח. שוטפים את העלים היטב, מעבירים לקערת מי הקרח ומשהים 10 דקות, מה שהופך אותם לזקופים ופריכים.\n2.	ממי הקרח מעבירים אותם למגבת מטבח, עוטפים היטב ושומרים במקרר עד להגשה.\n3.	מכינים את הוויניגרט: שמים בקערת מעבד מזון או בכד של בלנדר את השום, החומץ, הדבש, החרדל, המלח והפלפל השחור ומקציפים במהירות איטית. \n4.	מטפטפים פנימה באיטיות, ממש טיפה אחר טיפה, את השמן ומקציפים עוד קצת. \n5.	ממש לפני ההגשה, שמים בקערת הסלט את העלים ומוסיפים את הוויניגרט. מערבבים בעדינות כך שהוויניגרט יעטוף את העלים ומגישים. \n",                
                "cooking_time": 15,
                "servings": 4,
                "categories": "סלטים",
                "tags": "פרווה, טבעוני, ללא גלוטן" ,
                "image_filename": "green_salad.jpg",
                "ingredients": [
                    {"name": "חסה סלנובה", "quantity": 2, "unit": "יחידות"},
                    {"name": "חסה ערבית", "quantity": 1, "unit": "יחידות"},
                    {"name": "חסה אייסברג", "quantity": 0.5, "unit": "יחידות"},
                    {"name": "עלי בייבי", "quantity": 0.5, "unit": "יחידות"},
                    {"name": "שן שום", "quantity": 1, "unit": "יחידה"},
                    {"name": "חומץ בלסמי", "quantity": 0.3, "unit": "כוס"},
                    {"name": "דבש", "quantity": 1, "unit": "כפית"},
                    {"name": "חרדל דיז'ון", "quantity": 1, "unit": "כפית"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"},
                    {"name": "שמן זית", "quantity": 6, "unit": "כפות"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 15, "label": "לישת הבצק"},
                    {"step_number": 2, "duration": 90, "label": "התפחה "},
                    {"step_number": 8, "duration": 12, "label": "אפייה "},
                ],
                "nutrition": {
                    "calories": 1047.75,
                    "protein": 8.17,
                    "carbs": 405.51,
                    "fats": 32.91
                }
            },
            {
                "name": "סלט גזר חמצמץ וחריף",
                "preparation_steps": "1.	קולפים את הגזר ואת השום.\n2.	חותכים את הגזר והפלפל לגפרורים דקים. מגרדים את קליפת הלימון וסוחטים את המיץ. קוצצים את השום. \n3.	מניחים את כל רכיבי הרוטב בקערה ומערבבים. \n4.	מניחים את רכיבי הסלט בקערה ומערבבים. יוצקים את הרוטב על הסלט ומערבבים היטב. \n",
                "cooking_time": 15,
                "servings": 4,
                "categories": "סלטים",
                "tags": "טבעוני, ללא גלוטן, פרווה" ,
                "image_filename": "carrot.jpg",
                "ingredients": [
                    {"name": "גזר", "quantity": 4, "unit": "יחידות"},
                    {"name": "פלפל צ'ילי ירוק", "quantity": 1, "unit": "יחידה"},
                    {"name": "כוסברה", "quantity": 1, "unit": "צרור"},
                    {"name": "שמן זית", "quantity": 3, "unit": "כפות"},
                    {"name": "מיץ לימון", "quantity": 3, "unit": "כפות"},
                    {"name": "קליפת לימון", "quantity": 1, "unit": "כפית"},
                    {"name": "דבש", "quantity": 1, "unit": "כפית"},
                    {"name": "שן שום", "quantity": 1, "unit": "יחידה"},
                    {"name": "מלח", "quantity": 1, "unit": "כף"},
                    {"name": "פלפל שחור גרוס", "quantity": 1, "unit": "כפית"}
                ],
                "timers": [],
                "nutrition": {
                    "calories": 1248.0,
                    "protein": 8.67,
                    "carbs": 399.75,
                    "fats": 37.07
                }
            },
            #קינוחים
           {
                "name": "קייק פופ משגעים",
                "preparation_steps": "1.	מכינים עוגת וניל: מערבבים את כל המצרכים לפי הסדר. מוזגים לתבנית אינגליש קייק ואופים ב-170 מעלות כ-40 דקות להזהבה והתייצבות. מקררים לחלוטין.\n2.	מפוררים בידיים את העוגה שהתקררה (אפשר במעבד מזון). \n3.	מכינים תערובת קייק פופס: מערבבים מיכל שמנת חמוצה (200 מ”ל) עם 2 כפות אבקת סוכר. \n4.	מוסיפים בהדרגה לפירורים, עד שמקבלים מרקם ‘בוץ’ שמתאחד בלחיצה. יוצרים מהעיסה כדורים, טובלים קצה מקל סוכריה בזפירו (לפי צבע הציפוי הסופי) ונועצים לעומק כל כדור. מקפיאים 10 דקות. \n5.	מקשטים: ממיסים את הזפירו, טובלים כל כדור בזפירו מכל סוג שרוצים ומקשטים בסוכריות וממרחים שונים וצבעוניים בשקית זילוף.*אפשר להניח את הקייקפופ כשהמקל כלפי מעלה על נייר אפייה (ואז יהיה להן ‘ראש שטוח’). לכדור מושלם נועצים את הקייקפופ בקלקר או בסטנד ייעודי עם חורים. \n",
                "cooking_time": 150,
                "servings": 25,
                "categories": "קינוחים",
                "tags": "חלבי" ,
                "image_filename": "cake_pop.jpg",
                "ingredients": [
                    {"name": "שמנת מתוקה", "quantity": 1, "unit": "מיכל"},
                    {"name": "ביצים", "quantity": 2, "unit": "יחידות"},
                    {"name": "סוכר לבן", "quantity": 0.75, "unit": "כוס"},
                    {"name": "קמח תופח", "quantity": 1, "unit": "כוס"},
                    {"name": "שמנת חמוצה", "quantity": 1, "unit": "מיכל"},
                    {"name": "אבקת סוכר", "quantity": 2, "unit": "כפות"},
                    {"name": "מטבעות שוקולד מריר", "quantity": 300, "unit": "גרם"},
                    {"name": "מטבעות שוקולד לבן", "quantity": 300, "unit": "גרם"},
                    {"name": "מטבעות שוקולד חלב", "quantity": 300, "unit": "גרם"}
                ],
                "timers": [
                    {"step_number": 1, "duration": 40, "label": "אפיית העוגה"},
                    {"step_number": 4, "duration": 10, "label": "הקפאת הכדורים "}
                ],
                "nutrition": {
                    "calories": 118.0,
                    "protein": 1.33,
                    "carbs": 15.88,
                    "fats": 5.41
                }
            },
            {
                "name": "עוגת שמרים שוקולד",
                "preparation_steps": "1.	מניחים במיקסר עם וו לישה את הקמח, השמרים, הסוכר והביצים.\n2.	מחממים את החלב עד שהוא חמים ומוסיפים אליו את החמאה.\n3.	מוסיפים לקערת המיקסר את החמאה והחלב ויחד איתם את המלח. \n4.	מערבלים את כל רכיבי הבצק במשך 5 דקות במהירות נמוכה-בינונית עד לקבלת בצק חלק, רך, מבריק ומעט דביק. \n5.	מכסים בנייר נצמד ומניחים בטמפרטורת החדר כ-30 דקות ואז מכניסים למקרר למשך לילה, או ל-4 שעות לפחות. \n6.	מכינים את המלית: ממיסים במיקרוגל את החמאה והשוקולד, מוסיפים את אבקת הסוכר והקקאו ומערבבים היטב עד שאין גושים. \n7.	מצננים את התערובת בטמפרטורת החדר, עד שהיא במרקם של קרם. בקיץ אפשר גם להכניס למקרר. \n8.	מחלקים את הבצק לשני חלקים (עבור 2 תבניות אינגליש קייק) ומרדדים בעזרת מערוך את החלק הראשון למלבן על משטח מעט מקומח. \n9.	מורחים חצי ממלית השוקולד בעזרת פלטה ומגלגלים לרולדה. \n10.	חותכים לאורך הרולדה לשבלולים ומסדרים בתבנית עם הרווחים בין שבלול לשבלול. \n11.	חוזרים על הפעולה עם החלק השני של הבצק. מניחים לבצק לתפוח למשך כ-30 דקות בקיץ, עד שעה בחורף. \n12.	מחממים את התנור ל-160 מעלות ומרפדים תבנית בנייר אפיי,  טורפים את הביצה עם מעט מים. \n13.	מברישים את השבלולים בביצה ואופים את העוגות כ-25 דקות עד שהחלק העליון שלהן שחום ומבפנים לא רואים בצק לא אפוי. \n",
                "cooking_time": 45,
                "servings": 2,
                "categories": "קינוחים",
                "tags": "חלבי" ,
                "image_filename": "cake.jpg",
                "ingredients": [
                    {"name": "קמח לבן", "quantity": 500, "unit": "גרם"},
                    {"name": "שמרים יבשים", "quantity": 1, "unit": "כף"},
                    {"name": "סוכר לבן", "quantity": 0.5, "unit": "כוס"},
                    {"name": "חמאה", "quantity": 100, "unit": "גרם"},
                    {"name": "חלב", "quantity": 0.6, "unit": "כוס"},
                    {"name": "ביצים", "quantity": 2, "unit": "יחידות"},
                    {"name": "מלח", "quantity": 2, "unit": "כפיות"},
                    {"name": "שוקולד מריר", "quantity": 100, "unit": "גרם"},
                    {"name": "חמאה", "quantity": 100, "unit": "גרם"},
                    {"name": "אבקת סוכר", "quantity": 5, "unit": "כפות"},
                    {"name": "אבקת קקאו", "quantity": 3, "unit": "כפות"},
                    {"name": "ביצה", "quantity": 1, "unit": "יחידה"}
                    
                ],
                "timers": [
                    {"step_number": 4, "duration": 5, "label": "ערבול"},
                    {"step_number": 5, "duration": 60, "label": "התפחה"},
                    {"step_number": 11, "duration": 30, "label": "התפחה חוזרת"},
                    {"step_number": 13, "duration": 25, "label": "אפייה"},
                ],
                "nutrition": {
                    "calories": 1830.0,
                    "protein": 55.83,
                    "carbs": 856.92,
                    "fats": 52.52
                }
            },
            {
                "name": "קפקייק שוקולד עם קצפת",
                "preparation_steps": "1.	מחממים את התנור לחום של 170 מעלות.\n2.	שמים בקערה גדולה את השמן, הביצה, החלמון, החלב, הסוכר והמלח וטורפים לתערובת אחידה בעזרת מטרפה ידנית. \n3.	מוסיפים את הקקאו, הקמח ואבקת האפייה וטורפים עד שהחומרים היבשים נטמעים בתערובת. \n4.	יוצקים את הבלילה לתבנית שקעים משומנת קלות. ממלאים עד לכ-2/3 מגובה. \n5.	אופים במשך 15-20 דקות, או עד שהקאפקייקס תפוחים, וקיסם הננעץ במרכז יוצא עם פירורים לחים. מצננים לחלוטין לפני הקישוט. \n6.	מכינים את הקצפת: מקציפים יחד במיקסר עם וו בלון את השמנת, אבקת הסוכר והאינסטנט פודינג עד שמתקבלת קצפת יציבה מאוד. \n7.	מעבירים את הקצפת לתוך שקית זילוף מוציאים את האוויר וסוגרים. חותכים את הקצה. \n8.	מזלפים תלוליות הקצפת מעל הקאפקייקס, מקשטים בסוכריות הצבעוניות ומגישים. ",
                "cooking_time": 55,
                "servings": 12,
                "categories": "קינוחים",
                "tags": "חלבי" ,
                "image_filename": "capcake.jpg",
                "ingredients": [
                    {"name": "שמן קנולה", "quantity": 0.5, "unit": "כוס"},
                    {"name": "ביצה", "quantity": 1, "unit": "יחידה"},
                    {"name": "חלמון", "quantity": 1, "unit": "יחידה"},
                    {"name": "חלב", "quantity": 0.75, "unit": "כוס"},
                    {"name": "סוכר לבן", "quantity": 1, "unit": "כוס"},
                    {"name": "מלח", "quantity": 1, "unit": "כפית"},
                    {"name": "אבקת קקאו", "quantity": 6, "unit": "כפות"},
                    {"name": "קמח לבן", "quantity": 0.75, "unit": "כוס"},
                    {"name": "אבקת אפייה", "quantity": 1, "unit": "כפית"},
                    {"name": "שמנת מתוקה", "quantity": 1.5, "unit": "מיכל"},
                    {"name": "אבקת סוכר", "quantity": 3, "unit": "כפות"},
                    {"name": "אינסטנט פודינג בטעם וניל", "quantity": 3, "unit": "כפות"}

                ],
                "timers": [
                    {"step_number": 5, "duration": 20, "label": "אפייה"}
                ],
                "nutrition": {
                    "calories": 592.92,
                    "protein": 6.68,
                    "carbs": 145.05,
                    "fats": 18.41
                }
            },
            {
                "name": "שטרודל תפוחים",
                "preparation_steps": "1.	קולפים את התפוחים וחותכים לקוביות קטנות, ללא הליבה.\n2.	מכינים את המילוי: מחממים מחבת על כיריים וממיסים את החמאה. מוסיפים את קוביות התפוחים, הקינמון והסוכר. מערבבים ומבשלים עד שנוצר קרמל. מעבירים לקערה להתקררות.\n3.	מוסיפים לקערה את הקורנפלור והאגוזים ומערבבים היטב.\n4.	מחממים את התנור ל-180 מעלות בפונקציית 4D. מרפדים תבנית לחם מלבנית בנייר אפייה (אפשר גם לאפות בתבנית תנור רגילה מרופדת בנייר אפייה). \n5.	בזמן שהמילוי מתקרר פורשים את בצק העלים על משטח העבודה וחותכים אותו בעזרת גלגלת עד לאמצע לרצועות ארוכות ודקות. מניחים את המילוי על החלק השלם של הבצק ומגלגלים כך שהרצועות יהיו בחלק העליון של השטרודל. מקפלים את הפינות ומעבירים את המאפה לתוך התבנית. \n6.	אופים כחצי שעה או להזהבה. \n7.	מערבבים את אבקת הסוכר עם הקורנפלור ומפזרים על השטרודל. \n",
                "cooking_time": 120,
                "servings": 10,
                "categories": "קינוחים",
                "tags": "חלבי" ,
                "image_filename": "strudel.jpg",
                "ingredients": [
                    {"name": "בצק עלים", "quantity": 1, "unit": "חבילה"},
                    {"name": "תפוחי עץ", "quantity": 5, "unit": "יחידות"},
                    {"name": "חמאה", "quantity": 50, "unit": "גרם"},
                    {"name": "קינמון טחון", "quantity": 1, "unit": "כפית"},
                    {"name": "סוכר חום כהה", "quantity": 2, "unit": "כפות"},
                    {"name": "סוכר חום", "quantity": 2, "unit": "כפות"},
                    {"name": "אגוזי מלך", "quantity": 0.5, "unit": "כוס"},
                    {"name": "עמילן טירס", "quantity": 1, "unit": "כף"},
                    {"name": "אבקת סוכר", "quantity": 0.25, "unit": "גרם"},
                    {"name": "עמילן תירס", "quantity": 0.5, "unit": "כף"} 
                ],
                "timers": [
                    {"step_number": 6, "duration": 30, "label": "אפייה"}
                ],
                "nutrition": {
                    "calories": 292.4,
                    "protein": 3.78,
                    "carbs": 47.83,
                    "fats": 10.74
                }
            },
        ]
        #Add new recipe
        for recipe_data in seed_recipes:
            image_path = f"/static/{recipe_data['image_filename']}"
            new_recipe = Recipe(
                name=recipe_data["name"],
                preparation_steps=recipe_data["preparation_steps"],
                cooking_time=recipe_data["cooking_time"],
                servings=recipe_data["servings"],
                categories=recipe_data["categories"],
                tags=recipe_data["tags"],
                creator_id=admin_user.id,
                image_url=image_path
            )
            db.add(new_recipe)
            db.flush()  # Retrieve new recipe ID

            for ingredient in recipe_data["ingredients"]:
                new_ingredient = Ingredient(
                    name=ingredient["name"],
                    quantity=ingredient["quantity"],
                    unit=ingredient["unit"],
                    recipe_id=new_recipe.id
                )
                db.add(new_ingredient)

            for timer in recipe_data["timers"]:
                new_timer = CookingTimer(
                    recipe_id=new_recipe.id,
                    step_number=timer["step_number"],
                    duration=timer["duration"],
                    label=timer["label"]
                )
                db.add(new_timer)
                start_timer(f"recipe_{new_recipe.id}_step_{timer['step_number']}", timer["duration"])

            if "nutrition" in recipe_data:
                nutrition_data = recipe_data["nutrition"]
                new_nutrition = NutritionalInfo(
                    recipe_id=new_recipe.id,
                    calories=nutrition_data["calories"],
                    protein=nutrition_data["protein"],
                    carbs=nutrition_data["carbs"],
                    fats=nutrition_data["fats"]
                )
                db.add(new_nutrition)

        db.commit()
        print("✅ Seed data loaded successfully!")

    except Exception as e:
        print(f"❌ Error loading seed data: {str(e)}")
        db.rollback()
        raise